import math
from sympy import *
from Crypto.Util.number import long_to_bytes

n1 = 128021258692239348503546730221241450036109326325930885112795043583313557300860010131968115032155183016682855158547276699092449120994404903536113123213307276851109789193658645537761137625670217521065366635434847172827807516114752873774487121853691727102240139809388323126416986279478897105648820628804142193337
c1 = 13917543028798320150765227784871562393138367168426982716171613619883914744058194018423788261215163402520052837437752635737243855002121135881194342257032889574709432025822570487102222716884748033915616092087083186655464766127650730820662943636799135212093960033690140312387232001018677877392576980999080249397
c2 = 36186039656364530558623819819857226198166093348044226138296946940854892300121816202143647234715502034027547524663901828051183712240676973739814385438015936972144884224637045918121126081329586902576970922757968534080390358482760415292390304842993840348858226100240450516480480523903446993814400215516810728042
pista = 396779903265200376830663552999441970489256849289823562085746970759966701353983481291662198561941849940522909836566091131961942026756764683352846377010757552967658399749504419120515061123521621772109993209128913763585488755729031131403163685277954658555896694841689279098023885443655267019300832811893510269803646562288524773939716729368115042366193580932637852638780833322346651681159635360221852368978225174680252170411170378744556759748961136214920286554914257616457078858

e = 0x10001

n2 = pista % n1

q = math.gcd(n1, n2)

p = n1 // q
z = n2 // q

tn1 = (p-1)*(q-1)
tn2 = (q-1)*(z-1)

ei1 = pow(e, -1, tn1)
ei2 = pow(e, -1, tn2)

print(e)
print(f'{ei1} : {ei2}')

m1 = pow(c1, ei1, n1)
m2 = pow(c2, ei2, n2)

mensaje = long_to_bytes(m1) + long_to_bytes(m2)

print(mensaje.decode())
